<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" href="./views/css/styles.css">
    <title>Chat PHP</title>
</head>
<body>
<h1>Chat Online - PHP</h1>
<a href="index.php">Inicio</a> -

<?php
if($_SESSION['user']->getName()=="")
	echo '<a href="index.php?login">Iniciar Sesi&oacute;n</a></br>';
else{
	echo 'Bienvenido '.$_SESSION['user']->getName().' ';
    if($_SESSION['user']->getRole()==1){
	    echo ' - <a href="index.php?administration">Panel de administración</a> ';
	} 
   
    echo ' - <a href="index.php?login&logout">Salir</a>';
}
/* Al conectarse el usuario el status cambia a 1 para mostrar los usuarios conectados. Al desconectarse el status pasa a 0. Crear un formulario de envío de mensajes donde se 
selecciona usuario y un botón para enviar mensajes creando un chat si no lo hubiera ya activo.
Crear un repositorio de mensajes (id_message, id_send, id_receiver, content, date). que carga los mensajes
al cargar el chat  */
?>
<main>
    <aside>
        <div class="connected-users">
            <ul>
                <?php
                foreach($usuariosConectados as $usuario){
                    echo'<li>'.$usuario->getName().'</li>';
                }
                ?>
            </ul>
        </div>
        <div class="pie">
            <button> admin </button>
            <button> salir </button>
        </div>
    </aside>

    <section>
        <div class="message-container">
        <?php
            foreach($messages as $message){
                echo '<div class="message">
                '.$message->getUser()->getName().': '.$message->getMsg().'
                </div>';
            }
            
        ?>
        </div>
        
        <form action="index.php" method="post">
            <textarea rows=5 cols=150 name="message"></textarea>
            <input type="submit" name="sendMessage" value="Enviar mensaje">
        </form>
    </section>

</main>
<footer>
    <h5>&copy;2022 Juan Tom&aacute;s Romero, Jesús Muela, Antonio Ruiz</h5>
</footer> 
</body>
</html>